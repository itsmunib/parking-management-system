<%- include('partials/header') %>
<style>
  .exit-container {
    max-width: 800px;
    margin: 0 auto;
    padding: 20px;
  }
  .entries-table {
    margin-top: 20px;
  }
</style>
<h2 class="text-center mb-4">Vehicle Exit</h2>
<div class="exit-container">
  <% if (error) { %>
    <div class="alert alert-danger text-center"><%= error %></div>
  <% } %>
  <!-- Entries Table -->
  <table class="table table-bordered entries-table">
    <thead>
      <tr>
        <th>Number Plate</th>
        <th>Entry Time</th>
        <th>Owner Name</th>
        <th>Phone</th>
        <th>Category</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody>
      <% if (entries && entries.length > 0) { %>
        <% entries.forEach(entry => { %>
          <tr>
            <td><%= entry.number_plate %></td>
            <td><%= new Date(entry.entry_time).toLocaleString() %></td>
            <td><%= entry.owner_name || 'N/A' %></td>
            <td><%= entry.phone || 'N/A' %></td>
            <td><%= entry.category || 'Unknown' %></td>
            <td>
              <form action="/exit" method="POST">
                <input type="hidden" name="entry_id" value="<%= entry.id %>">
                <button type="submit" class="btn btn-sm btn-danger" onclick="return confirm('Are you sure you want to process this exit?');">Exit</button>
              </form>
            </td>
          </tr>
        <% }) %>
      <% } else { %>
        <tr>
          <td colspan="6" class="text-center">No vehicles currently parked.</td>
        </tr>
      <% } %>
    </tbody>
  </table>
</div>
<%- include('partials/footer') %>