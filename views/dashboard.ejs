<%- include('partials/header') %>
<style>
  .space-bar {
    height: 20px;
    margin-bottom: 10px;
  }
  .space-bar.available {
    background-color: #28a745;
  }
  .space-bar.parked {
    background-color: #dc3545;
  }
</style>
<h2 class="text-center mb-4">Dashboard</h2>
<% if (error) { %>
  <div class="alert alert-danger text-center"><%= error %></div>
<% } %>
<div class="container">
  <div class="row mb-4">
    <div class="col-md-4">
      <div class="card text-center">
        <div class="card-body">
          <h5 class="card-title">Vehicles (<%= filter.charAt(0).toUpperCase() + filter.slice(1) %>)</h5>
          <p class="card-text"><%= vehicles %></p>
        </div>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card text-center">
        <div class="card-body">
          <h5 class="card-title">Earnings (<%= filter.charAt(0).toUpperCase() + filter.slice(1) %>)</h5>
          <p class="card-text text-center" id="earnings">PKR <%= (Number(earnings) || 0).toFixed(2) %></p>
        </div>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card text-center">
        <div class="card-body">
          <h5 class="card-title">Space Usage</h5>
          <div class="space-bar available" style="width: <%= totalSpaces > 0 ? (available / totalSpaces) * 100 : 0 %>%;"></div>
          <div>Available Spaces: <%= available %></div>
          <div class="space-bar parked" style="width: <%= totalSpaces > 0 ? ((totalSpaces - available) / totalSpaces) * 100 : 0 %>%;"></div>
          <div>Used Spaces: <%= totalSpaces - available %></div>
        </div>
      </div>
    </div>
  </div>
  <div class="row mb-4">
    <div class="col-12 text-center">
      <a href="/dashboard?filter=today" class="btn btn-<%= filter === 'today' ? 'primary' : 'secondary' %> mx-2">Today</a>
      <a href="/dashboard?filter=weekly" class="btn btn-<%= filter === 'weekly' ? 'primary' : 'secondary' %> mx-2">Weekly</a>
      <a href="/dashboard?filter=monthly" class="btn btn-<%= filter === 'monthly' ? 'primary' : 'secondary' %> mx-2">Monthly</a>
    </div>
  </div>
</div>
<%- include('partials/footer') %>